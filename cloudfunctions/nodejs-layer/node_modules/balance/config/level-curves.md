# level-curves.json 字段说明

此文件定义基础战斗属性的默认值与若干公式边界。`config-loader` 会先读取对应 `profile`，缺失字段自动回退到默认 `v1`。主要结构：

- `version`：默认使用的版本标识。
- `profiles`：各版本配置。
  - `v1`（默认完整配置）
    - `defaults`
      - `combatStats`：角色基础战斗属性的初始值，缺省时 combat-system 会使用它们作为新角色属性基线并支持别名映射。【F:cloudfunctions/nodejs-layer/node_modules/combat-system/index.js†L4-L89】
        - 包含 `maxHp`、`physicalAttack`、`magicAttack`、`physicalDefense`、`magicDefense`、`speed`、`accuracy`、`dodge`、`critRate`、`critDamage`、`finalDamageBonus`、`finalDamageReduction`、`lifeSteal`、`healingBonus`、`healingReduction`、`controlHit`、`controlResist`、`physicalPenetration`、`magicPenetration`、`critResist`、`comboRate`、`block`、`counterRate`、`damageReduction`、`healingReceived`、`rageGain`、`controlStrength`、`shieldPower`、`summonPower`、`elementalVulnerability` 等所有基础数值，各字段含义与战斗公式同名参数一致。
      - `specialStats`：特殊状态类属性默认值，供角色初始化使用，字段包括 `shield`、`bonusDamage`、`dodgeChance`、`healOnHit`、`healOnKill`、`damageReflection`、`accuracyBonus`、`speedBonus`、`physicalPenetrationBonus`、`magicPenetrationBonus`。
    - `hitFormula`：命中概率公式参数，提供 `base`（基础命中率）、`slope`（命中随等级或命中属性的增长斜率）、`min`、`max`（结果上下限）。
    - `penetration`：穿透系数控制，`scale` 为穿透属性对减防效果的转化比例，`max` 为减防率上限。
    - `baseDamage`：基础伤害浮动控制，`minAttackRatio` 为最低攻击占比，`randomMin` 与 `randomRange` 控制随机浮动区间，`minDamage` 为保底伤害。
    - `crit`：暴击率与暴击伤害的边界，`min`/`max` 为暴击触发概率范围，`damageMin` 为暴击伤害倍率下限。
    - `finalDamage`：终伤加成/减免相关的截断配置，`minMultiplier` 为终伤下限，`bonusClamp`/`reductionClamp` 分别定义终伤加成与减免的最小/最大值。
    - `healing`：治疗与吸血相关限制，`lifeStealMax` 为吸血上限，`healingBonusClamp`、`healingReductionClamp`、`healingReceivedClamp` 控制各项治疗系数的上下限。
    - `mitigation`：减伤率上限，字段 `damageReductionMax`。
    - `procCaps`：触发类属性上限，包含 `comboRateMax`、`blockMax`、`counterRateMax`。
    - `specialCaps`：特殊效果上限，如 `dodgeChanceMax`、`damageReflectionMax`。
    - `statFloors`：关键属性的下限设置，目前包含 `critDamageMin`（暴击伤害下限），供战斗公式截断使用。【F:cloudfunctions/nodejs-layer/node_modules/combat-system/index.js†L67-L130】
  - `v2`（相对 v1 的增量覆盖）
    - `defaults`：空对象，表示沿用 v1 默认属性。
    - `hitFormula`：仅覆盖 `base`，将基础命中率提升至 0.87。
    - `baseDamage`：调整伤害浮动范围（`randomMin`=0.95，`randomRange`=0.22）。
    - `crit`：提高暴击下限（`min`=0.07）。

> 运行时通过 `getLevelCurveConfig()` 读取，未配置字段会回退到上述默认值，以确保战斗公式具备安全的上下限。配置还会被 combat-system 用于计算属性界限与截断。【F:cloudfunctions/nodejs-layer/node_modules/balance/config-loader.js†L8-L75】【F:cloudfunctions/nodejs-layer/node_modules/combat-system/index.js†L91-L132】

## 主要字段的属性说明

### defaults.combatStats（基础战斗属性）

| 属性名 | 中文含义 | 默认值 | 备注 |
| --- | --- | --- | --- |
| `maxHp` | 最大生命值上限 | `2860` | 角色生命值基线 |
| `physicalAttack` | 物理攻击强度 | `82` | 物理输出基线 |
| `magicAttack` | 魔法攻击强度 | `82` | 魔法输出基线 |
| `physicalDefense` | 物理防御力 | `61` | 物理减伤基线 |
| `magicDefense` | 魔法防御力 | `61` | 魔法减伤基线 |
| `speed` | 速度（行动条增长率） | `92` | 影响行动条与出手顺序 |
| `accuracy` | 命中率 | `112` | 命中初始属性，用于命中公式 |
| `dodge` | 闪避率 | `96` | 闪避初始属性，用于闪避公式 |
| `critRate` | 暴击率 | `0.062` | 暴击触发起点 |
| `critDamage` | 暴击伤害倍数 | `1.52` | 暴击倍率起点 |
| `finalDamageBonus` | 终伤加成系数 | `0` | 终伤增益基线 |
| `finalDamageReduction` | 终伤减免系数 | `0.024` | 终伤减益基线 |
| `lifeSteal` | 吸血比例 | `0` | 攻击回血起点 |
| `healingBonus` | 主动治疗加成 | `0.08` | 治疗输出基线 |
| `healingReduction` | 对目标施加的治疗减免 | `0` | 施加治疗衰减的起点 |
| `controlHit` | 控制命中（影响控制类效果命中率） | `11` | 控制类命中基线 |
| `controlResist` | 控制抗性（抵抗控制效果） | `11` | 抵抗控制的基线 |
| `physicalPenetration` | 物理防御穿透 | `1` | 物防穿透起点 |
| `magicPenetration` | 魔法防御穿透 | `1` | 魔防穿透起点 |
| `critResist` | 暴击抵抗率 | `0.0184` | 抑制被暴击的起点 |
| `comboRate` | 连击触发概率 | `0` | 触发类概率基线 |
| `block` | 格挡率 | `0` | 格挡触发基线 |
| `counterRate` | 反击概率 | `0` | 反击触发基线 |
| `damageReduction` | 减伤率（通用伤害减免） | `0` | 固定减伤基线 |
| `healingReceived` | 受治疗加成 | `0` | 被治疗收益基线 |
| `rageGain` | 怒气获取效率 | `0` | 资源获取效率基线 |
| `controlStrength` | 控制强度（延长或强化控制效果） | `0` | 控制效果时长/强度基线 |
| `shieldPower` | 护盾强度加成 | `0` | 护盾效率基线 |
| `summonPower` | 召唤物强度系数 | `0` | 召唤物属性加成起点 |
| `elementalVulnerability` | 元素易伤系数 | `0` | 元素伤害易伤基线 |

### defaults.specialStats（特殊状态初始值）

| 属性名 | 中文含义 | 默认值 | 备注 |
| --- | --- | --- | --- |
| `shield` | 初始护盾值 | `0` | 角色创建时自带护盾 |
| `bonusDamage` | 额外伤害系数 | `0` | 触发额外伤害的倍率基线 |
| `dodgeChance` | 额外闪避概率 | `0` | 触发型闪避概率基线 |
| `healOnHit` | 攻击命中时回复生命比例 | `0` | 每次命中触发的自恢复 |
| `healOnKill` | 击杀后回复生命比例 | `0` | 击杀触发的自恢复 |
| `damageReflection` | 反弹伤害比例 | `0` | 反伤系数基线 |
| `accuracyBonus` | 额外命中加成 | `0` | 额外命中修正基线 |
| `speedBonus` | 额外速度加成 | `0` | 临时速度增益基线 |
| `physicalPenetrationBonus` | 额外物理穿透 | `0` | 额外物防穿透修正 |
| `magicPenetrationBonus` | 额外魔法穿透 | `0` | 额外魔防穿透修正 |

### baseDamage（基础伤害浮动）

| 属性名 | 中文含义 | 默认值 | 备注 |
| --- | --- | --- | --- |
| `minAttackRatio` | 伤害计算中攻击力占比的最低阈值 | `0.25` | 防止低攻击系数技能伤害过低，攻击占比不会被系数拉到 25% 以下 |
| `randomMin` | 随机浮动区间的起始值 | `0.9` | 伤害随机波动下限，保证随机段最低保留 90% |
| `randomRange` | 随机浮动幅度 | `0.2` | 伤害随机波动范围，默认可在 90%~110% 间抖动 |
| `minDamage` | 伤害保底值 | `1` | 确保极端情况下仍有伤害，不会出现 0 伤害 |

### finalDamage（终伤截断）

| 属性名 | 中文含义 | 默认值 | 备注 |
| --- | --- | --- | --- |
| `minMultiplier` | 终伤总乘区的最低倍率 | `0.1` | 终伤不会低于 10%，防止公式因负增益叠加后被压成 0 |
| `bonusClamp.min` | 终伤加成的最小截断值 | `-0.9` | 可被 Debuff 压到 -90%（终伤倍率最低 10%），负值表示反向削弱但截断防止跌穿 |
| `bonusClamp.max` | 终伤加成的最大截断值 | `2` | 终伤加成封顶 +200%，限制极端增益导致爆表 |
| `reductionClamp.min` | 终伤减免的最小截断值 | `0` | 终伤减免不允许为负，避免“反向增伤” |
| `reductionClamp.max` | 终伤减免的最大截断值 | `0.9` | 终伤减免最高 90%，配合 `minMultiplier` 避免无伤情形 |

### healing（治疗/吸血限制）

| 属性名 | 中文含义 | 默认值 | 备注 |
| --- | --- | --- | --- |
| `lifeStealMax` | 吸血比例上限 | `0.6` | 吸血最高 60%，防止无限续航/无敌循环 |
| `healingBonusClamp.min` | 治疗加成的最小截断值 | `-1` | 允许极端 Debuff 将治疗翻转到 -100%，相当于治疗变成等量伤害 |
| `healingBonusClamp.max` | 治疗加成的最大截断值 | `1.5` | 治疗增益最多放大 150%，避免过度堆叠 |
| `healingReductionClamp.min` | 治疗减免的最小截断值 | `-1` | 负值表示减免被反向削弱（-100% 时等同移除治疗减免） |
| `healingReductionClamp.max` | 治疗减免的最大截断值 | `1.5` | 治疗减免最多压制 150%，避免一刀切为 0 |
| `healingReceivedClamp.min` | 受治疗加成的最小截断值 | `-0.5` | 至少能接收到 50% 的治疗，负值意味着可被逆转但保留半效 |
| `healingReceivedClamp.max` | 受治疗加成的最大截断值 | `1.5` | 受治疗最多放大到 150%，防止单次治疗失衡 |

### procCaps（触发类上限）

| 属性名 | 中文含义 | 默认值 | 备注 |
| --- | --- | --- | --- |
| `comboRateMax` | 连击概率上限 | `1` | 触发概率最高 100%，超过时截断防止概率溢出 |
| `blockMax` | 格挡概率上限 | `1` | 格挡概率最高 100%，避免公式溢出导致无上限减伤 |
| `counterRateMax` | 反击概率上限 | `1` | 反击概率最高 100%，确保概率事件可控 |

### specialCaps（特殊效果上限）

| 属性名 | 中文含义 | 默认值 | 备注 |
| --- | --- | --- | --- |
| `dodgeChanceMax` | 闪避概率上限 | `0.8` | 附加闪避最高 80%，保留命中空间 |
| `damageReflectionMax` | 反弹伤害比例上限 | `0.8` | 反伤比例最高 80%，避免反伤大于原伤害 |

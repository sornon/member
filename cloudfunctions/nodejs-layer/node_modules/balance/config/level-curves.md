# level-curves.json 字段说明

此文件定义基础战斗属性的默认值与若干公式边界。`config-loader` 会先读取对应 `profile`，缺失字段自动回退到默认 `v1`。主要结构：

- `version`：默认使用的版本标识。
- `profiles`：各版本配置。
  - `v1`（默认完整配置）
    - `defaults`
      - `combatStats`：角色基础战斗属性的初始值，缺省时 combat-system 会使用它们作为新角色属性基线并支持别名映射。【F:cloudfunctions/nodejs-layer/node_modules/combat-system/index.js†L4-L89】
        - 包含 `maxHp`、`physicalAttack`、`magicAttack`、`physicalDefense`、`magicDefense`、`speed`、`accuracy`、`dodge`、`critRate`、`critDamage`、`finalDamageBonus`、`finalDamageReduction`、`lifeSteal`、`healingBonus`、`healingReduction`、`controlHit`、`controlResist`、`physicalPenetration`、`magicPenetration`、`critResist`、`comboRate`、`block`、`counterRate`、`damageReduction`、`healingReceived`、`rageGain`、`controlStrength`、`shieldPower`、`summonPower`、`elementalVulnerability` 等所有基础数值，各字段含义与战斗公式同名参数一致。
      - `specialStats`：特殊状态类属性默认值，供角色初始化使用，字段包括 `shield`、`bonusDamage`、`dodgeChance`、`healOnHit`、`healOnKill`、`damageReflection`、`accuracyBonus`、`speedBonus`、`physicalPenetrationBonus`、`magicPenetrationBonus`。
    - `hitFormula`：命中概率公式参数，提供 `base`（基础命中率）、`slope`（命中随等级或命中属性的增长斜率）、`min`、`max`（结果上下限）。
    - `penetration`：穿透系数控制，`scale` 为穿透属性对减防效果的转化比例，`max` 为减防率上限。
    - `baseDamage`：基础伤害浮动控制，`minAttackRatio` 为最低攻击占比，`randomMin` 与 `randomRange` 控制随机浮动区间，`minDamage` 为保底伤害。
    - `crit`：暴击率与暴击伤害的边界，`min`/`max` 为暴击触发概率范围，`damageMin` 为暴击伤害倍率下限。
    - `finalDamage`：终伤加成/减免相关的截断配置，`minMultiplier` 为终伤下限，`bonusClamp`/`reductionClamp` 分别定义终伤加成与减免的最小/最大值。
    - `healing`：治疗与吸血相关限制，`lifeStealMax` 为吸血上限，`healingBonusClamp`、`healingReductionClamp`、`healingReceivedClamp` 控制各项治疗系数的上下限。
    - `mitigation`：减伤率上限，字段 `damageReductionMax`。
    - `procCaps`：触发类属性上限，包含 `comboRateMax`、`blockMax`、`counterRateMax`。
    - `specialCaps`：特殊效果上限，如 `dodgeChanceMax`、`damageReflectionMax`。
    - `statFloors`：关键属性的下限设置，目前包含 `critDamageMin`（暴击伤害下限），供战斗公式截断使用。【F:cloudfunctions/nodejs-layer/node_modules/combat-system/index.js†L67-L130】
  - `v2`（相对 v1 的增量覆盖）
    - `defaults`：空对象，表示沿用 v1 默认属性。
    - `hitFormula`：仅覆盖 `base`，将基础命中率提升至 0.87。
    - `baseDamage`：调整伤害浮动范围（`randomMin`=0.95，`randomRange`=0.22）。
    - `crit`：提高暴击下限（`min`=0.07）。

> 运行时通过 `getLevelCurveConfig()` 读取，未配置字段会回退到上述默认值，以确保战斗公式具备安全的上下限。配置还会被 combat-system 用于计算属性界限与截断。【F:cloudfunctions/nodejs-layer/node_modules/balance/config-loader.js†L8-L75】【F:cloudfunctions/nodejs-layer/node_modules/combat-system/index.js†L91-L132】

## 主要字段的属性说明

### defaults.combatStats（基础战斗属性）

| 属性名 | 中文含义 | 默认值 |
| --- | --- | --- |
| `maxHp` | 最大生命值上限 | `2860` |
| `physicalAttack` | 物理攻击强度 | `82` |
| `magicAttack` | 魔法攻击强度 | `82` |
| `physicalDefense` | 物理防御力 | `61` |
| `magicDefense` | 魔法防御力 | `61` |
| `speed` | 速度（行动条增长率） | `92` |
| `accuracy` | 命中率 | `112` |
| `dodge` | 闪避率 | `96` |
| `critRate` | 暴击率 | `0.062` |
| `critDamage` | 暴击伤害倍数 | `1.52` |
| `finalDamageBonus` | 终伤加成系数 | `0` |
| `finalDamageReduction` | 终伤减免系数 | `0.024` |
| `lifeSteal` | 吸血比例 | `0` |
| `healingBonus` | 主动治疗加成 | `0.08` |
| `healingReduction` | 对目标施加的治疗减免 | `0` |
| `controlHit` | 控制命中（影响控制类效果命中率） | `11` |
| `controlResist` | 控制抗性（抵抗控制效果） | `11` |
| `physicalPenetration` | 物理防御穿透 | `1` |
| `magicPenetration` | 魔法防御穿透 | `1` |
| `critResist` | 暴击抵抗率 | `0.0184` |
| `comboRate` | 连击触发概率 | `0` |
| `block` | 格挡率 | `0` |
| `counterRate` | 反击概率 | `0` |
| `damageReduction` | 减伤率（通用伤害减免） | `0` |
| `healingReceived` | 受治疗加成 | `0` |
| `rageGain` | 怒气获取效率 | `0` |
| `controlStrength` | 控制强度（延长或强化控制效果） | `0` |
| `shieldPower` | 护盾强度加成 | `0` |
| `summonPower` | 召唤物强度系数 | `0` |
| `elementalVulnerability` | 元素易伤系数 | `0` |

### defaults.specialStats（特殊状态初始值）

| 属性名 | 中文含义 | 默认值 |
| --- | --- | --- |
| `shield` | 初始护盾值 | `0` |
| `bonusDamage` | 额外伤害系数 | `0` |
| `dodgeChance` | 额外闪避概率 | `0` |
| `healOnHit` | 攻击命中时回复生命比例 | `0` |
| `healOnKill` | 击杀后回复生命比例 | `0` |
| `damageReflection` | 反弹伤害比例 | `0` |
| `accuracyBonus` | 额外命中加成 | `0` |
| `speedBonus` | 额外速度加成 | `0` |
| `physicalPenetrationBonus` | 额外物理穿透 | `0` |
| `magicPenetrationBonus` | 额外魔法穿透 | `0` |

### baseDamage（基础伤害浮动）

| 属性名 | 中文含义 | 默认值 |
| --- | --- | --- |
| `minAttackRatio` | 伤害计算中攻击力占比的最低阈值 | `0.25` |
| `randomMin` | 随机浮动区间的起始值 | `0.9` |
| `randomRange` | 随机浮动幅度 | `0.2` |
| `minDamage` | 伤害保底值 | `1` |

### finalDamage（终伤截断）

| 属性名 | 中文含义 | 默认值 |
| --- | --- | --- |
| `minMultiplier` | 终伤总乘区的最低倍率 | `0.1` |
| `bonusClamp.min` | 终伤加成的最小截断值 | `-0.9` |
| `bonusClamp.max` | 终伤加成的最大截断值 | `2` |
| `reductionClamp.min` | 终伤减免的最小截断值 | `0` |
| `reductionClamp.max` | 终伤减免的最大截断值 | `0.9` |

### healing（治疗/吸血限制）

| 属性名 | 中文含义 | 默认值 |
| --- | --- | --- |
| `lifeStealMax` | 吸血比例上限 | `0.6` |
| `healingBonusClamp.min` | 治疗加成的最小截断值 | `-1` |
| `healingBonusClamp.max` | 治疗加成的最大截断值 | `1.5` |
| `healingReductionClamp.min` | 治疗减免的最小截断值 | `-1` |
| `healingReductionClamp.max` | 治疗减免的最大截断值 | `1.5` |
| `healingReceivedClamp.min` | 受治疗加成的最小截断值 | `-0.5` |
| `healingReceivedClamp.max` | 受治疗加成的最大截断值 | `1.5` |

### procCaps（触发类上限）

| 属性名 | 中文含义 | 默认值 |
| --- | --- | --- |
| `comboRateMax` | 连击概率上限 | `1` |
| `blockMax` | 格挡概率上限 | `1` |
| `counterRateMax` | 反击概率上限 | `1` |

### specialCaps（特殊效果上限）

| 属性名 | 中文含义 | 默认值 |
| --- | --- | --- |
| `dodgeChanceMax` | 闪避概率上限 | `0.8` |
| `damageReflectionMax` | 反弹伤害比例上限 | `0.8` |

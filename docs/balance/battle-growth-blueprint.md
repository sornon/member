## 2. 角色等级成长曲线
- 战斗属性覆盖：生命 `maxHp`、物攻 `physicalAttack`、法攻 `magicAttack`、物防 `physicalDefense`、法防 `magicDefense`、速度 `speed`、命中 `accuracy`、闪避 `dodge`、暴击率 `critRate`、暴击伤害 `critDamage`、终伤增减 `finalDamageBonus` / `finalDamageReduction` 以及控制命中/抗性、治疗/护盾/怒气获取等扩展；基础字段与装备词条保持一致，便于叠加与归一化。【F:cloudfunctions/pve/index.js†L2532-L2599】【F:cloudfunctions/pve/index.js†L2690-L2725】
- 曲线设计原则：前 10 级提供明显跃升，中期 11~40 级平滑但保持成长感，40 级后预留指数/境界跳阶空间，避免数值过早封顶。
- 推荐公式（`level≥1`，系数可写入成长配置表）：
  - 生命：`HP(level)=HP_base×(1+0.24×level^1.08)`
  - 攻击（双攻同式）：`ATK(level)=ATK_base×(1+0.2×level^1.06)`
  - 防御（双防同式）：`DEF(level)=DEF_base×(1+0.17×level^1.05)`
  - 速度：`SPD(level)=SPD_base×(1+0.08×level^0.95)`（速度曲线偏缓，控制多动风险）
  - 命中/闪避：`ACC/DOD(level)=STAT_base×(1+0.12×level^1.0)`
  - 暴击率：`CR(level)=min(0.06+0.0035×level,0.36)`；暴伤：`CD(level)=1.45+0.011×level^0.9`（软上限 2.5）。
- 关键等级示例（假设 1 级基础：HP 850、ATK 85、DEF 42、SPD 100、ACC 50）：
  - 1 级：HP≈1,043，ATK≈103，DEF≈55，SPD≈108，命中≈56，暴击≈9.5%
  - 10 级：HP≈3,950，ATK≈340，DEF≈182，SPD≈161，命中≈98，暴击≈41%
  - 20 级：HP≈8,300，ATK≈720，DEF≈370，SPD≈218，命中≈160，暴击≈36%（封顶后缓冲）
  - 30 级：HP≈14,100，ATK≈1,220，DEF≈610，SPD≈265，命中≈223
  - 50 级：HP≈30,000，ATK≈2,420，DEF≈1,200，SPD≈350，命中≈345
  - 80 级：HP≈63,500，ATK≈4,900，DEF≈2,420，SPD≈470，命中≈520
- 成长节奏说明：
  - 新手（1~10）：攻防血量增幅 >20%/级，保证明显的强力反馈；暴击率快速逼近 30% 上限以提升爽感。
  - 中期（11~40）：指数系数趋缓，保持 8~12 回合的 PVE/PVP 战斗长度；速度增长放缓以控制先手滚雪球。
  - 后期（41+）：可在突破节点对 `HP_base`、`ATK_base` 额外乘 1.08~1.12，保证长期扩展空间并与装备/境界叠加。

## 3. 装备成长与数值结构
- 现状概览：
  - 槽位：武器、头部、衣服、鞋、腰带、护腕、宝珠、项链、信物、傀儡、法器、秘宝等，每槽位绑定主属性候选与标签（攻、防、速度、控制）。【F:cloudfunctions/pve/index.js†L2532-L2607】
  - 品质：凡品→下品→中品→上品→极品→仙品→完美→先天→至宝，品质决定主属性系数（0.8~2.3）、副属性条数（0~3）与词条段位。【F:cloudfunctions/pve/index.js†L2670-L2723】
  - 词条规则：属性类型含平铺与百分比，基础值与每级增量明确（如 `maxHp` base 420/perLevel 70，`finalDamageBonus` base 0.05/perLevel 0.0018）。【F:cloudfunctions/pve/index.js†L2724-L2763】
- 品质差异设计（同等级同槽位主属性系数）：凡品 1.0、下品 1.1、中品 1.25、上品 1.45、极品 1.65、仙品 1.9、完美 2.1、先天 2.35、至宝 2.6；副属性条数随品质 0→1→1→1→2→2→2→3→3，词条段位依次提升。
- 强化/升星曲线建议（与等级独立）：
  - 强化等级 `enh∈[0,20]`：主属性 ×`(1+0.045×enh+0.0025×enh^2)`，使 0→10 级约 ×1.7，20 级约 ×2.5。
  - 升星：每 5 级强化触发 1 星，星级×`(1+0.08×star)`，并解锁/提升 1 条副属性档位，最高 4 星。
- 装备属性构成与槽位倾向：
  - 武器/法器/宝珠偏攻击与终伤，衣服/腰带/信物偏 HP 与减伤，鞋偏速度与闪避，护腕/秘宝兼顾攻防辅助；怒气获取、控制命中等功能词条分布在项链/傀儡/饰品类槽位。【F:cloudfunctions/pve/index.js†L2532-L2607】【F:cloudfunctions/pve/index.js†L2607-L2635】
  - 副属性档位按 `EQUIPMENT_AFFIX_TIER_MULTIPLIER` (0.85~1.55) 缩放，保证高品质在同等级下的边际优势。【F:cloudfunctions/pve/index.js†L2720-L2727】
- 同等级属性差距范围（设计期望）：
  - 裸装角色使用等级曲线的 100% 基础属性；满配（高品质+20 强化+满副属性）角色可达到基础的 1.8~2.2 倍攻击、1.6~2.0 倍生命/防御，速度提升 15%~25%，为 PVE/PVP 留出操作空间而不至于一边倒。
  - 品质跨度造成的瞬时跳变不超过 20%，通过强化曲线平滑过渡，降低掉落 RNG 对战力的极端影响。

## 4. 技能成长与伤害模型
- 分类框架：
  - 单体爆发（高倍率、可暴击），群体输出（中倍率、多目标），持续/召唤型（分段伤害），控制（低伤害、附带眩晕/减速/沉默），治疗/护盾（恢复/吸收伤害），资源/增益（怒气回复、增伤/减伤）。
  - 层级划分：基础技能（学习门槛低，倍率 0.8~1.0），高级技能（倍率 1.0~1.4 或多段），终极技能（倍率 1.5~2.2 或强控/大范围），按获取难度和资源消耗递进。
- 伤害公式框架（与现有战斗模型兼容）：
  - `SkillDamage = (ATK_main × SkillCoef(skillLv, tier) + FlatBonus) × (1 + FinalBonus) × Crit/Random/Defense`；其中 `ATK_main` 取物攻/法攻较高者或按技能类型定向。
  - `SkillCoef(skillLv, tier) = BaseCoef(tier) + GrowthCoef(tier) × (skillLv-1)`，`BaseCoef` 与 `GrowthCoef` 随技能层级设置，确保随等级线性/阶梯增长，避免指数爆炸。
  - 控制/治疗类沿用同一框架，治疗系数可设置为攻击系数的 60%~80%，再乘治疗专属系数；控制技能的伤害可降至 0.3~0.6，重点在效果强度/命中率。
- 基础倍率与成长模式建议：
  - 单体爆发：`Base=1.0~1.2`，`Growth=0.04~0.06`；终极可起始 1.5，成长 0.07，冷却长/消耗高以控制爆发频率。
  - 群体输出：`Base=0.6~0.85`，`Growth=0.03~0.045`，覆盖 3~5 目标，或改用“首目标 100%、其余 70%”的分摊倍率保持稳定。
  - 持续/召唤：每跳 `Base=0.35~0.45`，`Growth=0.02~0.03`，跳数 3~4；总伤害略低于同资源的爆发技能，换取稳定性。
  - 控制附伤：`Base=0.25~0.5`，`Growth=0.015~0.02`，控制效果按独立命中/抗性判定；纯控制可将伤害归零。
  - 治疗/护盾：治疗 `Base=0.65~0.8`，`Growth=0.03~0.05`；护盾以“治疗量 ×1.1~1.3”换算或按最大生命百分比设上限，避免后期无限叠盾。
  - 资源/增益：直接数值（怒气 +10~20）或百分比增益（增伤 15% 持续 2~3 回合），与伤害无关但需冷却/消耗约束。
- 与角色/装备成长的叠加约束：
  - 伤害依赖 `ATK_main` 与终伤系数，技能倍率采用线性/分段线性成长，避免与角色指数式属性叠加导致后期爆炸；终极技能可加“资源阈值 + 冷却”双重门槛控制频率。
  - 暴击、终伤、穿透等乘区保持 1~2 个可配置常量，技能自身不要再叠额外指数乘区；群体与治疗技能可引入“PVP 模式系数”降低无限拉扯风险。
  - 建议将 `BaseCoef/GrowthCoef` 配置化，随版本可微调而不改代码；并为 PVE/PVP 留独立倍率入口以平衡不同模式体验。
- 示例技能（虚构）：
  - 【裂空斩·单体爆发】（基础级）：`Base=1.05`，`Growth=0.05`，冷却 1 回合，消耗 20 怒气。
    - 1 级系数 1.05，相当于 ~1.05 次普攻；10 级系数 1.5（≈1.5 普攻）；20 级系数 2.05（≈2.0 普攻）。
  - 【雷鸣斩·群体】（高级）：`Base=0.75`，`Growth=0.035`，首目标 100%，其余 70%，冷却 2 回合，消耗 30 怒气。
    - 1 级首目标 0.75/副目标 0.525；10 级 1.065/0.746；20 级 1.415/0.991（单体等效 ~1.0~1.4 普攻，群体溅射兼顾清场）。
  - 【星落庇护·治疗护盾】（终极支援）：治疗 `Base=0.7`，`Growth=0.04`，护盾=治疗量×1.2，冷却 3 回合，消耗 40 怒气。
    - 1 级治疗 0.7×攻击，相当于 0.7 次普攻的恢复；10 级 1.06；20 级 1.46，护盾量随之放大但受“最大生命 35%”上限约束，避免后期无上限叠盾。
